import{m as e,a as t,r as s,j as a,w as o,F as r,s as l,h as i,e as n,S as c,v as p,o as d,u,c as g,i as h,k as m,p as f,l as y,q as x,t as k}from"./index-B8Pvg4bB.js";import{u as T}from"./global.B1UtntyB.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=b({data:()=>({groupedData:[],types:["a人文·历史·建筑·大学","b艺术·展馆·书苑·剧院","c行业·科学·技术·专业","d寺庙·坛观·宗教·教堂","e游乐·度假·表演·小镇","g商场·商圈·零售·百货","h园区·大厦·酒店·建筑","i公园·山水·自然·美景","k胡同·交通·美食·其他"],da:[],currentGroupIndex:0,scrollTop:0,tabClickTime:0,noNet:!1,video:!1,refresherTriggered:!1}),computed:{...t(T,["myGlobalData","noNet","video"]),...e(T,["selectedPlace","source","filterItem","navIds"])},onShow(){const e=T();this.noNet=e.noNet,this.video=e.video},onLoad(){n({title:"加载数据中..."});const e=T();this.da=e.myGlobalData,this.groupData()},onTabItemTap(e){const t=(new Date).getTime();t-this.tabClickTime<300&&(this.scrollTop=.1,this.$nextTick(()=>{this.scrollTop=0})),this.tabClickTime=t},methods:{onRefresherRefresh(){this.refresherTriggered=!0,setTimeout(()=>{this.refresherTriggered=!1},500)},groupData(){const e=this.da,t=this.types,s={},a={};e.forEach(e=>{const o=e.type&&e.type.length>0?e.type[0]:"k";s[o]||(s[o]=this.getFullGroupName(o,t)),a[o]||(a[o]={groupName:s[o],expanded:!0,items:[]}),a[o].items.push(e)});for(const r in a){a[r].items.sort((e,t)=>(t.rate||0)-(e.rate||0));const e=a[r].items.length;a[r].groupName=`${a[r].groupName} (${e})`}const o=Object.values(a);o.sort((e,t)=>{const s=this.getTypeChar(e.groupName),a=this.getTypeChar(t.groupName);return s.localeCompare(a)}),this.currentGroupIndex=0,this.groupedData=[],this.loadNextGroup(o)},getTypeChar:e=>e.charAt(0),loadNextGroup(e){if(this.currentGroupIndex>=e.length)return void i();const t=e[this.currentGroupIndex];this.groupedData.push(t),this.currentGroupIndex++,setTimeout(()=>{this.loadNextGroup(e)},50)},getFullGroupName(e,t){for(let s=0;s<t.length;s++)if(t[s][0]===e)return t[s].slice(1);return e},toggleGroup(e){this.groupedData[e].expanded=!this.groupedData[e].expanded},onPlaceTap(e){this.selectedPlace=e,this.source="video",l({url:"/pages/map/map",success:function(e){console.log("跳转成功")},fail:function(e){console.error("跳转失败:",e)}})},onPlaceTap2(e){const t=e.items.map(e=>e.title);this.source="video",this.filterItem=e.groupName,this.navIds=t,l({url:"/pages/map/map",success:function(e){console.log("跳转成功")},fail:function(e){console.error("跳转失败:",e)}})},toggleEx(){this.groupedData.forEach(e=>{e.expanded=!1}),this.scrollTop=.1,this.$nextTick(()=>{this.scrollTop=0})},getPrice:e=>0==e?"免费":"元"==String(e).slice(-1)||String(e).length>3?e:"￥"+e+"元",getTags:e=>e.recomend?e.recomend.split("，"):[]}},[["render",function(e,t,l,i,n,T){const b=f,_=h,v=p,N=c;return d(),s(r,null,[a(N,{id:"scroll","enable-passive":!0,"show-scrollbar":!1,"scroll-with-animation":"true","scroll-top":n.scrollTop,"refresher-enabled":!0,"refresher-triggered":n.refresherTriggered,onRefresherrefresh:T.onRefresherRefresh,style:{height:"100vh",overflow:"hidden"},"scroll-y":"true"},{default:o(()=>[(d(!0),s(r,null,u(n.groupedData,(e,t)=>(d(),g(_,{key:t,class:"group"},{default:o(()=>[a(_,{class:"group-title",onClick:e=>T.toggleGroup(t)},{default:o(()=>[a(b,{onClick:y(t=>T.onPlaceTap2(e),["stop"]),style:{"font-size":"16px",color:"#1769e4"}},{default:o(()=>[x(k(e.groupName),1)]),_:2},1032,["onClick"]),a(b,{style:{"padding-left":"0px","font-size":"13px",color:"#911ae0"}},{default:o(()=>[x(k(e.expanded?"收起":"展开"),1)]),_:2},1024)]),_:2},1032,["onClick"]),e.expanded?(d(),g(_,{key:0,class:"group-items"},{default:o(()=>[(d(!0),s(r,null,u(e.items,(l,i)=>(d(),s(r,{key:l.id||i},[i%2==0?(d(),g(_,{key:0,class:"item"},{default:o(()=>[a(_,{id:"place_"+t+"_"+i,class:"place",style:{"margin-right":"5px"},onClick:e=>T.onPlaceTap(l)},{default:o(()=>[a(v,{src:n.noNet?"":l.img,mode:"aspectFill","lazy-load":!0},null,8,["src"]),n.video&&l.video?(d(),g(_,{key:0,class:"play-icon"})):m("",!0),a(b,{class:"single"},{default:o(()=>[x(k(l.title),1)]),_:2},1024),a(_,{class:"star-rating"},{default:o(()=>[(d(),s(r,null,u(5,e=>a(v,{key:e,src:e-1<l.rate?"/static/images/star-filled.png":"/static/images/star-empty.png",mode:"aspectFill"},null,8,["src"])),64))]),_:2},1024)]),_:2},1032,["id","onClick"]),i+1<e.items.length?(d(),g(_,{key:0,id:"place_"+t+"_"+(i+1),class:"place",style:{"margin-left":"5px"},onClick:t=>T.onPlaceTap(e.items[i+1])},{default:o(()=>[a(v,{src:n.noNet?"":e.items[i+1].img,mode:"aspectFill","lazy-load":!0},null,8,["src"]),n.video&&e.items[i+1].video?(d(),g(_,{key:0,class:"play-icon"})):m("",!0),a(b,{class:"single"},{default:o(()=>[x(k(e.items[i+1].title),1)]),_:2},1024),a(_,{class:"star-rating"},{default:o(()=>[(d(),s(r,null,u(5,t=>a(v,{key:t,src:t-1<e.items[i+1].rate?"/static/images/star-filled.png":"/static/images/star-empty.png",mode:"aspectFill"},null,8,["src"])),64))]),_:2},1024)]),_:2},1032,["id","onClick"])):(d(),g(_,{key:1,class:"place",style:{"margin-left":"5px",visibility:"hidden",border:"none","box-shadow":"none"}}))]),_:2},1024)):m("",!0)],64))),128))]),_:2},1024)):m("",!0)]),_:2},1024))),128))]),_:1},8,["scroll-top","refresher-triggered","onRefresherrefresh"]),a(v,{class:"back-to-top-btn",style:{"box-sizing":"border-box",padding:"5px"},onClick:T.toggleEx,src:"./static/images/zhedie.png"},null,8,["onClick"])],64)}],["__scopeId","data-v-a63d11be"]]);export{_ as default};
